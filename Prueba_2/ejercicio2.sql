/*Creacion de tabla costos*/
CREATE TABLE costos(
    tipoDeLlamada varchar(15) primary key,
    costo decimal(10,4)
);
/*Creacion de tabla logDial*/
CREATE TABLE logDial (
    idLlamada varchar(10) primary key,
    fechaDeLlamada date not null,
    tiempoDialogo smallint not null,
    telefono varchar(10) not null,
    tipoDeLlamada varchar(15) not null,
    foreign key (tipoDeLlamada) references costos(tipoDeLlamada)
);
/*Insersion de datos en tabla costos*/
INSERT INTO costos VALUES("Cel",0.4);
INSERT INTO costos VALUES("LD nacional",0.12);
INSERT INTO costos VALUES("Cel LD",0.5);
/*Insersion de datos en tabla logDial*/
INSERT INTO logDial VALUES('197463','2020-01-01','60','8000000001','Cel LD');
INSERT INTO logDial VALUES('197464','2020-01-02','60','8000000002','Cel LD');
INSERT INTO logDial VALUES('197465','2020-01-03','240','8000000003','Cel LD');
INSERT INTO logDial VALUES('197466','2020-01-04','60','8000000004','Cel LD');
INSERT INTO logDial VALUES('197467','2020-01-05','60','8000000005','Cel LD');
INSERT INTO logDial VALUES('197468','2020-01-06','60','8000000006','Cel LD');
INSERT INTO logDial VALUES('197469','2020-01-07','60','8000000007','Cel');
INSERT INTO logDial VALUES('197470','2020-01-08','120','8000000008','LD nacional');
INSERT INTO logDial VALUES('197471','2020-01-09','60','8000000009','Cel LD');
INSERT INTO logDial VALUES('197472','2020-01-10','60','8000000010','Cel LD');
INSERT INTO logDial VALUES('197473','2020-01-11','120','8000000011','Cel LD');
INSERT INTO logDial VALUES('197474','2020-01-12','60','8000000012','LD nacional');
INSERT INTO logDial VALUES('197475','2020-01-13','60','8000000013','LD nacional');
INSERT INTO logDial VALUES('197476','2020-01-14','60','8000000014','Cel');
INSERT INTO logDial VALUES('197477','2020-01-15','120','8000000015','Cel LD');
INSERT INTO logDial VALUES('197478','2020-01-16','60','8000000016','Cel LD');
INSERT INTO logDial VALUES('197479','2020-01-17','60','8000000017','Cel');
INSERT INTO logDial VALUES('197480','2020-01-18','60','8000000018','Cel LD');
INSERT INTO logDial VALUES('197481','2020-01-19','180','8000000019','LD nacional');
INSERT INTO logDial VALUES('197482','2020-01-20','120','8000000020','LD nacional');
INSERT INTO logDial VALUES('197483','2020-01-21','60','8000000021','Cel LD');
INSERT INTO logDial VALUES('197484','2020-01-22','60','8000000022','Cel LD');
INSERT INTO logDial VALUES('197485','2020-01-23','60','8000000023','Cel LD');
INSERT INTO logDial VALUES('197486','2020-01-24','120','8000000024','Cel LD');
INSERT INTO logDial VALUES('197487','2020-01-25','60','8000000025','Cel LD');
INSERT INTO logDial VALUES('197488','2020-01-26','60','8000000026','Cel LD');
INSERT INTO logDial VALUES('197489','2020-01-27','120','8000000027','Cel LD');
INSERT INTO logDial VALUES('197490','2020-01-28','60','8000000028','Cel LD');
INSERT INTO logDial VALUES('197491','2020-01-29','76','8000000029','Cel LD');
INSERT INTO logDial VALUES('197492','2020-01-30','60','8000000030','Cel LD');
INSERT INTO logDial VALUES('197493','2020-01-31','60','8000000031','Cel');
INSERT INTO logDial VALUES('197494','2020-02-01','60','8000000032','Cel');
INSERT INTO logDial VALUES('197495','2020-02-02','60','8000000033','Cel');
INSERT INTO logDial VALUES('197496','2020-02-03','240','8000000034','Cel LD');
INSERT INTO logDial VALUES('197497','2020-02-04','60','8000000035','Cel LD');
INSERT INTO logDial VALUES('197498','2020-02-05','240','8000000036','Cel LD');
INSERT INTO logDial VALUES('197499','2020-02-06','120','8000000037','Cel LD');
INSERT INTO logDial VALUES('197500','2020-02-07','95','8000000038','Cel LD');
INSERT INTO logDial VALUES('197501','2020-02-08','60','8000000039','Cel LD');
INSERT INTO logDial VALUES('197502','2020-02-09','60','8000000040','Cel LD');
INSERT INTO logDial VALUES('197503','2020-02-10','360','8000000041','Cel LD');
INSERT INTO logDial VALUES('197504','2020-02-11','60','8000000042','Cel');
INSERT INTO logDial VALUES('197505','2020-02-12','60','8000000043','Cel LD');
INSERT INTO logDial VALUES('197506','2020-02-13','60','8000000044','Cel LD');
INSERT INTO logDial VALUES('197507','2020-02-14','120','8000000045','Cel LD');
INSERT INTO logDial VALUES('197508','2020-02-15','60','8000000046','Cel LD');
INSERT INTO logDial VALUES('197509','2020-02-16','60','8000000047','Cel LD');
INSERT INTO logDial VALUES('197510','2020-02-17','120','8000000048','Cel LD');
INSERT INTO logDial VALUES('197511','2020-02-18','120','8000000049','Cel LD');
INSERT INTO logDial VALUES('197512','2020-02-19','60','8000000050','Cel LD');
INSERT INTO logDial VALUES('197513','2020-02-20','85','8000000051','Cel LD');
INSERT INTO logDial VALUES('197514','2020-02-21','60','8000000052','Cel');
INSERT INTO logDial VALUES('197515','2020-02-22','60','8000000053','Cel');
INSERT INTO logDial VALUES('197516','2020-02-23','120','8000000054','Cel LD');
INSERT INTO logDial VALUES('197517','2020-02-24','120','8000000055','Cel LD');
INSERT INTO logDial VALUES('197518','2020-02-25','240','8000000056','Cel LD');
INSERT INTO logDial VALUES('197519','2020-02-26','60','8000000057','Cel LD');
INSERT INTO logDial VALUES('197520','2020-02-27','180','8000000058','Cel LD');
INSERT INTO logDial VALUES('197521','2020-02-28','180','8000000059','Cel LD');
INSERT INTO logDial VALUES('197522','2020-02-29','120','8000000060','Cel');
INSERT INTO logDial VALUES('197523','2020-03-01','60','8000000061','Cel');
INSERT INTO logDial VALUES('197524','2020-03-02','60','8000000062','Cel LD');
INSERT INTO logDial VALUES('197525','2020-03-03','120','8000000063','Cel LD');
INSERT INTO logDial VALUES('197526','2020-03-04','60','8000000064','Cel LD');
INSERT INTO logDial VALUES('197527','2020-03-05','60','8000000065','Cel');
INSERT INTO logDial VALUES('197528','2020-03-06','60','8000000066','Cel LD');
INSERT INTO logDial VALUES('197529','2020-03-07','60','8000000067','Cel');
INSERT INTO logDial VALUES('197530','2020-03-08','60','8000000068','Cel LD');
INSERT INTO logDial VALUES('197531','2020-03-09','60','8000000069','Cel LD');
INSERT INTO logDial VALUES('197532','2020-03-10','60','8000000070','Cel LD');
INSERT INTO logDial VALUES('197533','2020-03-11','60','8000000071','Cel LD');
INSERT INTO logDial VALUES('197534','2020-03-12','120','8000000072','Cel LD');
INSERT INTO logDial VALUES('197535','2020-03-13','60','8000000073','Cel LD');
INSERT INTO logDial VALUES('197536','2020-03-14','60','8000000074','Cel');
INSERT INTO logDial VALUES('197537','2020-03-15','60','8000000075','Cel LD');
INSERT INTO logDial VALUES('197538','2020-03-16','120','8000000076','Cel LD');
INSERT INTO logDial VALUES('197539','2020-03-17','60','8000000077','Cel');
INSERT INTO logDial VALUES('197540','2020-03-18','60','8000000078','Cel LD');
INSERT INTO logDial VALUES('197541','2020-03-19','86','8000000079','Cel LD');
INSERT INTO logDial VALUES('197542','2020-03-20','120','8000000080','Cel');
INSERT INTO logDial VALUES('197543','2020-03-21','120','8000000081','Cel LD');
INSERT INTO logDial VALUES('197544','2020-03-22','60','8000000082','Cel LD');
INSERT INTO logDial VALUES('197545','2020-03-23','77','8000000083','Cel LD');
INSERT INTO logDial VALUES('197546','2020-03-24','60','8000000084','Cel');
INSERT INTO logDial VALUES('197547','2020-03-25','60','8000000085','Cel LD');
INSERT INTO logDial VALUES('197548','2020-03-26','120','8000000086','Cel LD');
INSERT INTO logDial VALUES('197549','2020-03-27','180','8000000087','Cel LD');
INSERT INTO logDial VALUES('197550','2020-03-28','180','8000000088','Cel LD');
INSERT INTO logDial VALUES('197552','2020-03-30','60','8000000090','LD nacional');
INSERT INTO logDial VALUES('197553','2020-03-31','60','8000000091','Cel LD');
INSERT INTO logDial VALUES('197554','2020-04-01','60','8000000092','Cel LD');
INSERT INTO logDial VALUES('197555','2020-04-02','60','8000000093','Cel LD');
INSERT INTO logDial VALUES('197556','2020-04-03','180','8000000094','Cel');
INSERT INTO logDial VALUES('197557','2020-04-04','60','8000000095','Cel LD');
INSERT INTO logDial VALUES('197558','2020-04-05','196','8000000096','Cel');
INSERT INTO logDial VALUES('197559','2020-04-06','60','8000000097','Cel LD');
INSERT INTO logDial VALUES('197560','2020-04-07','60','8000000098','Cel');
INSERT INTO logDial VALUES('197561','2020-04-08','60','8000000099','Cel LD');
INSERT INTO logDial VALUES('197562','2020-04-09','60','8000000100','Cel');
INSERT INTO logDial VALUES('197563','2020-04-10','60','8000000101','Cel');
INSERT INTO logDial VALUES('197564','2020-04-11','60','8000000102','Cel LD');
INSERT INTO logDial VALUES('197565','2020-04-12','60','8000000103','Cel');
INSERT INTO logDial VALUES('197566','2020-04-13','120','8000000104','Cel LD');
INSERT INTO logDial VALUES('197567','2020-04-14','180','8000000105','Cel');
INSERT INTO logDial VALUES('197568','2020-04-15','60','8000000106','Cel LD');
INSERT INTO logDial VALUES('197569','2020-04-16','60','8000000107','Cel LD');
INSERT INTO logDial VALUES('197570','2020-04-17','60','8000000108','Cel LD');
INSERT INTO logDial VALUES('197571','2020-04-18','180','8000000109','Cel LD');
INSERT INTO logDial VALUES('197572','2020-04-19','60','8000000110','Cel LD');
INSERT INTO logDial VALUES('197573','2020-04-20','60','8000000111','LD nacional');
INSERT INTO logDial VALUES('197574','2020-04-21','60','8000000112','Cel LD');
INSERT INTO logDial VALUES('197575','2020-04-22','60','8000000113','Cel LD');
INSERT INTO logDial VALUES('197576','2020-04-23','60','8000000114','Cel LD');
INSERT INTO logDial VALUES('197577','2020-04-24','60','8000000115','Cel');
INSERT INTO logDial VALUES('197578','2020-04-25','60','8000000116','Cel LD');
INSERT INTO logDial VALUES('197579','2020-04-26','60','8000000117','Cel LD');
INSERT INTO logDial VALUES('197580','2020-04-27','240','8000000118','Cel LD');
INSERT INTO logDial VALUES('197581','2020-04-28','60','8000000119','Cel LD');
INSERT INTO logDial VALUES('197582','2020-04-29','60','8000000120','Cel LD');
INSERT INTO logDial VALUES('197583','2020-04-30','120','8000000121','Cel LD');
INSERT INTO logDial VALUES('197584','2020-05-01','60','8000000122','Cel LD');
INSERT INTO logDial VALUES('197585','2020-05-02','60','8000000123','Cel LD');
INSERT INTO logDial VALUES('197586','2020-05-03','120','8000000124','LD nacional');
INSERT INTO logDial VALUES('197587','2020-05-04','60','8000000125','Cel LD');
INSERT INTO logDial VALUES('197588','2020-05-05','60','8000000126','LD nacional');
INSERT INTO logDial VALUES('197589','2020-05-06','60','8000000127','Cel');
INSERT INTO logDial VALUES('197590','2020-05-07','60','8000000128','Cel LD');
INSERT INTO logDial VALUES('197591','2020-05-08','120','8000000129','Cel LD');
/*Primer Query*/
SELECT * from logDial WHERE MONTH(fechaDeLlamada)=2 AND tipoDeLlamada="CEL LD";
/*Segunda Query*/
SELECT AVG(tiempoDialogo) FROM logDial WHERE MONTH(fechaDeLlamada)=2 AND tipoDeLlamada="CEL LD";
/*Tercera Query*/
SELECT tiempoDialogo/60,(tiempoDialogo/60)*costo FROM logDial l LEFT JOIN costos c ON l.tipoDeLlamada = c.tipoDeLlamada WHERE MONTH(l.fechaDeLlamada)=2;